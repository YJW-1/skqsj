
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/Game/bat.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '9beb1/u689MO7zQZ1F/pFGj', 'bat');
// script/Game/bat.ts

Object.defineProperty(exports, "__esModule", { value: true });
var CocosZ_1 = require("../Framework/CocosZ");
var Constant_1 = require("../Framework/Constant");
var _a = cc._decorator, ccclass = _a.ccclass, property = _a.property;
var bat = /** @class */ (function (_super) {
    __extends(bat, _super);
    function bat() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.rb = null;
        _this.action = null;
        _this.startPos = null;
        _this.isStart = false;
        _this.isTwo = false;
        _this.isRight = false;
        _this.isFirst = false;
        return _this;
    }
    bat.prototype.onBeginContact = function (contact, self, other) {
        var _this = this;
        if (CocosZ_1.cocosz.dataMgr.CurLevelId == 49 && this.isStart)
            return;
        if (!this.isFirst) {
            CocosZ_1.cocosz.audioMgr.playBatEffect();
        }
        if (CocosZ_1.cocosz.dataMgr.CurLevelId == 106) {
            this.isFirst = true;
            this.isStart = true;
            var v_1 = this.rb.linearVelocity;
            if (v_1.x == 0) {
                if (this.action) {
                    this.action.stop();
                }
                cc.tween(this.node)
                    .to(0.1, { position: this.startPos })
                    .call(function () {
                    v_1.x = 450;
                    _this.rb.linearVelocity = v_1;
                })
                    .start();
            }
            if (other.tag == 0) {
                contact.disabled = true;
                if (v_1.x != 0) {
                    v_1.x *= -1;
                    if (v_1.x < 0 && v_1.x > -450) {
                        v_1.x = -450;
                    }
                    else if (v_1.x > 0 && v_1.x < 450) {
                        v_1.x = 450;
                    }
                    this.rb.linearVelocity = v_1;
                }
            }
            else if (other.tag == 123) {
                if (v_1.x != 0) {
                    v_1.x *= -1;
                    if (v_1.x < 0 && v_1.x > -450) {
                        v_1.x = -450;
                    }
                    else if (v_1.x > 0 && v_1.x < 450) {
                        v_1.x = 450;
                    }
                    this.rb.linearVelocity = v_1;
                }
            }
            else if (other.tag == 124) {
                this.isTwo = true;
                if (v_1.x != 0) {
                    v_1.x *= -1;
                    if (v_1.x < 0 && v_1.x > -450) {
                        v_1.x = -450;
                    }
                    else if (v_1.x > 0 && v_1.x < 450) {
                        v_1.x = 450;
                    }
                    this.rb.linearVelocity = v_1;
                }
            }
        }
        else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 32) {
            this.isFirst = true;
            this.isStart = true;
            var v = this.rb.linearVelocity;
            if (other.tag == Constant_1.tag.beforeSucceedPoint)
                return;
            if (v.x == 0) {
                if (this.action) {
                    this.action.stop();
                }
                v.y = 450;
                this.rb.linearVelocity = v;
            }
        }
        else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 49 || CocosZ_1.cocosz.dataMgr.CurLevelId == 135) {
            this.isFirst = true;
            if (this.isStart)
                return;
            this.isStart = true;
            if (this.action) {
                this.action.stop();
            }
            var v_2 = this.rb.linearVelocity;
            v_2.x = 450;
            this.rb.linearVelocity = v_2;
            this.schedule(function () {
                cc.log("---------this.isRight---------", _this.isRight);
                _this.isRight = !_this.isRight;
                if (_this.isRight) {
                    v_2.x = -450;
                    _this.rb.linearVelocity = v_2;
                }
                else {
                    v_2.x = 450;
                    _this.rb.linearVelocity = v_2;
                }
            }, 3.3);
        }
        else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 35 || CocosZ_1.cocosz.dataMgr.CurLevelId == 124) {
            this.isStart = true;
            this.isFirst = true;
            var v_3 = this.rb.linearVelocity;
            cc.log("=================");
            if (v_3.x == 0) {
                if (this.action) {
                    this.action.stop();
                }
                cc.tween(this.node)
                    .to(0.1, { position: this.startPos })
                    .call(function () {
                    v_3.x = 300;
                    _this.rb.linearVelocity = v_3;
                })
                    .start();
            }
            if (other.tag == 7) {
                contact.disabled = true;
                if (v_3.x != 0) {
                    v_3.x *= -1;
                    if (v_3.x < 0 && v_3.x > -300) {
                        v_3.x = -300;
                    }
                    else if (v_3.x > 0 && v_3.x < 300) {
                        v_3.x = 300;
                    }
                    this.rb.linearVelocity = v_3;
                }
            }
            if (other.tag == 0) {
                if (v_3.x != 0) {
                    v_3.x *= -1;
                    if (v_3.x < 0 && v_3.x > -300) {
                        v_3.x = -300;
                    }
                    else if (v_3.x > 0 && v_3.x < 300) {
                        v_3.x = 300;
                    }
                    this.rb.linearVelocity = v_3;
                }
            }
        }
        else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 86) {
            this.isStart = true;
            this.isFirst = true;
            var v_4 = this.rb.linearVelocity;
            if (v_4.x == 0) {
                if (this.action) {
                    this.action.stop();
                }
                cc.tween(this.node)
                    .to(0.1, { position: this.startPos })
                    .call(function () {
                    v_4.x = 450;
                    _this.rb.linearVelocity = v_4;
                })
                    .start();
            }
            if (other.tag == 7) {
                contact.disabled = true;
                if (v_4.x != 0) {
                    v_4.x *= -1;
                    if (v_4.x < 0 && v_4.x > -450) {
                        v_4.x = -450;
                    }
                    else if (v_4.x > 0 && v_4.x < 450) {
                        v_4.x = 450;
                    }
                    this.rb.linearVelocity = v_4;
                }
            }
            if (other.tag == 0) {
                if (v_4.x != 0) {
                    v_4.x *= -1;
                    if (v_4.x < 0 && v_4.x > -450) {
                        v_4.x = -450;
                    }
                    else if (v_4.x > 0 && v_4.x < 450) {
                        v_4.x = 450;
                    }
                    this.rb.linearVelocity = v_4;
                }
            }
        }
        if (other.tag == Constant_1.tag.desPoint) {
            this.node.destroy();
        }
    };
    // LIFE-CYCLE CALLBACKS:
    bat.prototype.onLoad = function () {
        this.rb = this.node.getComponent(cc.RigidBody);
    };
    bat.prototype.start = function () {
        var _this = this;
        this.startPos = this.node.getPosition();
        var a = cc.tween().sequence(cc.tween().by(1, { position: cc.v2(0, 15) }), cc.tween().by(1, { position: cc.v2(0, -15) }));
        this.action = cc.tween(this.node)
            .repeatForever(a)
            .start();
        var b = cc.tween().sequence(cc.tween().by(0.1, { angle: 30 }), cc.tween().by(0.1, { angle: -30 }));
        cc.tween(this.node.getChildByName("bat_wing1"))
            .repeatForever(b)
            .start();
        var c = cc.tween().sequence(cc.tween().by(0.1, { angle: -30 }), cc.tween().by(0.1, { angle: 30 }));
        cc.tween(this.node.getChildByName("bat_wing2"))
            .repeatForever(c)
            .start();
        // if (cocosz.dataMgr.CurLevelId == 49) {
        //     if (this.isStart) return;
        //     this.isStart = true;
        //     if (this.action) {
        //         this.action.stop()
        //     }
        //     let v = this.rb.linearVelocity;
        //     v.x = 450;
        //     this.rb.linearVelocity = v;
        //     this.schedule(() => {
        //         cc.log("---------this.isRight---------", this.isRight)
        //         this.isRight = !this.isRight
        //         if (this.isRight) {
        //             v.x = -450;
        //             this.rb.linearVelocity = v;
        //         }
        //         else {
        //             v.x = 450;
        //             this.rb.linearVelocity = v;
        //         }
        //     }, 5)
        // }
        if (CocosZ_1.cocosz.dataMgr.CurLevelId == 35) {
            this.isStart = true;
            this.isFirst = true;
            var v_5 = this.rb.linearVelocity;
            if (v_5.x == 0) {
                if (this.action) {
                    this.action.stop();
                }
                cc.tween(this.node)
                    .to(0.1, { position: this.startPos })
                    .call(function () {
                    v_5.x = 300;
                    _this.rb.linearVelocity = v_5;
                })
                    .start();
            }
        }
    };
    bat.prototype.update = function (dt) {
        if (CocosZ_1.cocosz.dataMgr.CurLevelId != 35 && CocosZ_1.cocosz.dataMgr.CurLevelId != 124 && CocosZ_1.cocosz.dataMgr.CurLevelId != 32 && this.isStart && !this.isTwo) {
            var v = this.rb.linearVelocity;
            v.y = 0;
            this.rb.linearVelocity = v;
            cc.log("-------222");
        }
        else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 49 && this.isStart) {
            var v = this.rb.linearVelocity;
            v.y = 0;
            if (v.x > 10 && v.x < 450) {
                v.x = 450;
            }
            else if (v.x < 10 && v.x > -450) {
                v.x = -450;
            }
            // if (this.isRight) {
            //     v.x = 450;
            //     this.rb.linearVelocity = v;
            // }
            // else {
            //     v.x = -450;
            //     this.rb.linearVelocity = v;
            // }
            cc.log("----211---222");
            this.rb.linearVelocity = v;
        }
    };
    bat = __decorate([
        ccclass
    ], bat);
    return bat;
}(cc.Component));
exports.default = bat;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxHYW1lXFxiYXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDhDQUE2QztBQUM3QyxrREFBNEM7QUFFdEMsSUFBQSxrQkFBcUMsRUFBbkMsb0JBQU8sRUFBRSxzQkFBMEIsQ0FBQztBQUc1QztJQUFpQyx1QkFBWTtJQUQ3QztRQUFBLHFFQThUQztRQTNURyxRQUFFLEdBQWlCLElBQUksQ0FBQztRQUV4QixZQUFNLEdBQVEsSUFBSSxDQUFBO1FBQ2xCLGNBQVEsR0FBUSxJQUFJLENBQUE7UUFFcEIsYUFBTyxHQUFZLEtBQUssQ0FBQztRQUV6QixXQUFLLEdBQVksS0FBSyxDQUFDO1FBRXZCLGFBQU8sR0FBWSxLQUFLLENBQUE7UUFFeEIsYUFBTyxHQUFZLEtBQUssQ0FBQzs7SUFnVDdCLENBQUM7SUE5U0csNEJBQWMsR0FBZCxVQUFlLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSztRQUFuQyxpQkE0TEM7UUEzTEcsSUFBSSxlQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsSUFBSSxFQUFFLElBQUksSUFBSSxDQUFDLE9BQU87WUFBRSxPQUFPO1FBRTVELElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2YsZUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsQ0FBQztTQUNuQztRQUNELElBQUksZUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLElBQUksR0FBRyxFQUFFO1lBQ2xDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1lBQ3BCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1lBQ3BCLElBQUksR0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDO1lBQy9CLElBQUksR0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ1YsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO29CQUNiLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENB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QUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FDaEQsQ0FBQTtRQUVELElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2FBQzVCLGFBQWEsQ0FBQyxDQUFDLENBQUM7YUFDaEIsS0FBSyxFQUFFLENBQUE7UUFJWixJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUMsUUFBUSxDQUN2QixFQUFFLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUNqQyxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQ3JDLENBQUE7UUFHRCxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2FBQzFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7YUFDaEIsS0FBSyxFQUFFLENBQUE7UUFFWixJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUMsUUFBUSxDQUN2QixFQUFFLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQ2xDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQ3BDLENBQUE7UUFHRCxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2FBQzFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7YUFDaEIsS0FBSyxFQUFF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Q0wsQ0FBQztJQTVUZ0IsR0FBRztRQUR2QixPQUFPO09BQ2EsR0FBRyxDQTZUdkI7SUFBRCxVQUFDO0NBN1RELEFBNlRDLENBN1RnQyxFQUFFLENBQUMsU0FBUyxHQTZUNUM7a0JBN1RvQixHQUFHIiwiZmlsZSI6IiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29jb3N6IH0gZnJvbSBcIi4uL0ZyYW1ld29yay9Db2Nvc1pcIjtcclxuaW1wb3J0IHsgdGFnIH0gZnJvbSBcIi4uL0ZyYW1ld29yay9Db25zdGFudFwiO1xyXG5cclxuY29uc3QgeyBjY2NsYXNzLCBwcm9wZXJ0eSB9ID0gY2MuX2RlY29yYXRvcjtcclxuXHJcbkBjY2NsYXNzXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGJhdCBleHRlbmRzIGNjLkNvbXBvbmVudCB7XHJcblxyXG4gICAgcmI6IGNjLlJpZ2lkQm9keSA9IG51bGw7XHJcblxyXG4gICAgYWN0aW9uOiBhbnkgPSBudWxsXHJcbiAgICBzdGFydFBvczogYW55ID0gbnVsbFxyXG5cclxuICAgIGlzU3RhcnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBpc1R3bzogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIGlzUmlnaHQ6IGJvb2xlYW4gPSBmYWxzZVxyXG5cclxuICAgIGlzRmlyc3Q6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBvbkJlZ2luQ29udGFjdChjb250YWN0LCBzZWxmLCBvdGhlcikge1xyXG4gICAgICAgIGlmIChjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDQ5ICYmIHRoaXMuaXNTdGFydCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuaXNGaXJzdCkge1xyXG4gICAgICAgICAgICBjb2Nvc3ouYXVkaW9NZ3IucGxheUJhdEVmZmVjdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCA9PSAxMDYpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0ZpcnN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5pc1N0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgbGV0IHYgPSB0aGlzLnJiLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICAgICBpZiAodi54ID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2MudHdlZW4odGhpcy5ub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgIC50bygwLjEsIHsgcG9zaXRpb246IHRoaXMuc3RhcnRQb3MgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IDQ1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvdGhlci50YWcgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29udGFjdC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodi54ICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHYueCA8IDAgJiYgdi54ID4gLTQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAtNDUwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2LnggPiAwICYmIHYueCA8IDQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG90aGVyLnRhZyA9PSAxMjMpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2LnggIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueCAqPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodi54IDwgMCAmJiB2LnggPiAtNDUwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IC00NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHYueCA+IDAgJiYgdi54IDwgNDUwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IDQ1MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob3RoZXIudGFnID09IDEyNCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1R3byA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodi54ICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHYueCA8IDAgJiYgdi54ID4gLTQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAtNDUwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2LnggPiAwICYmIHYueCA8IDQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDMyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNGaXJzdCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTdGFydCA9IHRydWVcclxuICAgICAgICAgICAgbGV0IHYgPSB0aGlzLnJiLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICAgICBpZiAob3RoZXIudGFnID09IHRhZy5iZWZvcmVTdWNjZWVkUG9pbnQpIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKHYueCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbi5zdG9wKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHYueSA9IDQ1MDtcclxuICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNvY29zei5kYXRhTWdyLkN1ckxldmVsSWQgPT0gNDkgfHwgY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCA9PSAxMzUpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0ZpcnN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNTdGFydCkgcmV0dXJuO1xyXG4gICAgICAgICAgICB0aGlzLmlzU3RhcnQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLnN0b3AoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB2ID0gdGhpcy5yYi5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICAgICAgdi54ID0gNDUwO1xyXG4gICAgICAgICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYy5sb2coXCItLS0tLS0tLS10aGlzLmlzUmlnaHQtLS0tLS0tLS1cIiwgdGhpcy5pc1JpZ2h0KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1JpZ2h0ID0gIXRoaXMuaXNSaWdodFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueCA9IC00NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDMuMylcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCA9PSAzNSB8fCBjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDEyNCkge1xyXG4gICAgICAgICAgICB0aGlzLmlzU3RhcnQgPSB0cnVlXHJcbiAgICAgICAgICAgIHRoaXMuaXNGaXJzdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCB2ID0gdGhpcy5yYi5saW5lYXJWZWxvY2l0eTtcclxuXHJcblxyXG4gICAgICAgICAgICBjYy5sb2coXCI9PT09PT09PT09PT09PT09PVwiKVxyXG4gICAgICAgICAgICBpZiAodi54ID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2MudHdlZW4odGhpcy5ub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgIC50bygwLjEsIHsgcG9zaXRpb246IHRoaXMuc3RhcnRQb3MgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IDMwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvdGhlci50YWcgPT0gNykge1xyXG4gICAgICAgICAgICAgICAgY29udGFjdC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodi54ICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHYueCA8IDAgJiYgdi54ID4gLTMwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAtMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2LnggPiAwICYmIHYueCA8IDMwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAzMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvdGhlci50YWcgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHYueCAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi54ICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2LnggPCAwICYmIHYueCA+IC0zMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdi54ID0gLTMwMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodi54ID4gMCAmJiB2LnggPCAzMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdi54ID0gMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDg2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTdGFydCA9IHRydWVcclxuICAgICAgICAgICAgdGhpcy5pc0ZpcnN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgbGV0IHYgPSB0aGlzLnJiLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICAgICBpZiAodi54ID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2MudHdlZW4odGhpcy5ub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgIC50bygwLjEsIHsgcG9zaXRpb246IHRoaXMuc3RhcnRQb3MgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IDQ1MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvdGhlci50YWcgPT0gNykge1xyXG4gICAgICAgICAgICAgICAgY29udGFjdC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodi54ICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHYueCA8IDAgJiYgdi54ID4gLTQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAtNDUwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2LnggPiAwICYmIHYueCA8IDQ1MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvdGhlci50YWcgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHYueCAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi54ICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2LnggPCAwICYmIHYueCA+IC00NTApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdi54ID0gLTQ1MDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodi54ID4gMCAmJiB2LnggPCA0NTApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdi54ID0gNDUwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3RoZXIudGFnID09IHRhZy5kZXNQb2ludCkge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gTElGRS1DWUNMRSBDQUxMQkFDS1M6XHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIHRoaXMucmIgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlJpZ2lkQm9keSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnQoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRQb3MgPSB0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKTtcclxuXHJcbiAgICAgICAgbGV0IGEgPSBjYy50d2VlbigpLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICBjYy50d2VlbigpLmJ5KDEsIHsgcG9zaXRpb246IGNjLnYyKDAsIDE1KSB9KSxcclxuICAgICAgICAgICAgY2MudHdlZW4oKS5ieSgxLCB7IHBvc2l0aW9uOiBjYy52MigwLCAtMTUpIH0pXHJcbiAgICAgICAgKVxyXG5cclxuICAgICAgICB0aGlzLmFjdGlvbiA9IGNjLnR3ZWVuKHRoaXMubm9kZSlcclxuICAgICAgICAgICAgLnJlcGVhdEZvcmV2ZXIoYSlcclxuICAgICAgICAgICAgLnN0YXJ0KClcclxuXHJcblxyXG5cclxuICAgICAgICBsZXQgYiA9IGNjLnR3ZWVuKCkuc2VxdWVuY2UoXHJcbiAgICAgICAgICAgIGNjLnR3ZWVuKCkuYnkoMC4xLCB7IGFuZ2xlOiAzMCB9KSxcclxuICAgICAgICAgICAgY2MudHdlZW4oKS5ieSgwLjEsIHsgYW5nbGU6IC0zMCB9KVxyXG4gICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIGNjLnR3ZWVuKHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJhdF93aW5nMVwiKSlcclxuICAgICAgICAgICAgLnJlcGVhdEZvcmV2ZXIoYilcclxuICAgICAgICAgICAgLnN0YXJ0KClcclxuXHJcbiAgICAgICAgbGV0IGMgPSBjYy50d2VlbigpLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICBjYy50d2VlbigpLmJ5KDAuMSwgeyBhbmdsZTogLTMwIH0pLFxyXG4gICAgICAgICAgICBjYy50d2VlbigpLmJ5KDAuMSwgeyBhbmdsZTogMzAgfSlcclxuICAgICAgICApXHJcblxyXG5cclxuICAgICAgICBjYy50d2Vlbih0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiYXRfd2luZzJcIikpXHJcbiAgICAgICAgICAgIC5yZXBlYXRGb3JldmVyKGMpXHJcbiAgICAgICAgICAgIC5zdGFydCgpXHJcbiAgICAgICAgLy8gaWYgKGNvY29zei5kYXRhTWdyLkN1ckxldmVsSWQgPT0gNDkpIHtcclxuICAgICAgICAvLyAgICAgaWYgKHRoaXMuaXNTdGFydCkgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICB0aGlzLmlzU3RhcnQgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgICBpZiAodGhpcy5hY3Rpb24pIHtcclxuICAgICAgICAvLyAgICAgICAgIHRoaXMuYWN0aW9uLnN0b3AoKVxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gICAgIGxldCB2ID0gdGhpcy5yYi5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICAvLyAgICAgdi54ID0gNDUwO1xyXG4gICAgICAgIC8vICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAvLyAgICAgdGhpcy5zY2hlZHVsZSgoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coXCItLS0tLS0tLS10aGlzLmlzUmlnaHQtLS0tLS0tLS1cIiwgdGhpcy5pc1JpZ2h0KVxyXG4gICAgICAgIC8vICAgICAgICAgdGhpcy5pc1JpZ2h0ID0gIXRoaXMuaXNSaWdodFxyXG4gICAgICAgIC8vICAgICAgICAgaWYgKHRoaXMuaXNSaWdodCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHYueCA9IC00NTA7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH0sIDUpXHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICBpZiAoY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCA9PSAzNSkge1xyXG4gICAgICAgICAgICB0aGlzLmlzU3RhcnQgPSB0cnVlXHJcbiAgICAgICAgICAgIHRoaXMuaXNGaXJzdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCB2ID0gdGhpcy5yYi5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICAgICAgaWYgKHYueCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbi5zdG9wKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNjLnR3ZWVuKHRoaXMubm9kZSlcclxuICAgICAgICAgICAgICAgICAgICAudG8oMC4xLCB7IHBvc2l0aW9uOiB0aGlzLnN0YXJ0UG9zIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggPSAzMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXJ0KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUoZHQpIHtcclxuICAgICAgICBpZiAoY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCAhPSAzNSAmJiBjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkICE9IDEyNCAmJiBjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkICE9IDMyICYmIHRoaXMuaXNTdGFydCAmJiAhdGhpcy5pc1R3bykge1xyXG4gICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgIHYueSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICBjYy5sb2coXCItLS0tLS0tMjIyXCIpXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDQ5ICYmIHRoaXMuaXNTdGFydCkge1xyXG4gICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgIHYueSA9IDA7XHJcbiAgICAgICAgICAgIGlmICh2LnggPiAxMCAmJiB2LnggPCA0NTApIHtcclxuICAgICAgICAgICAgICAgIHYueCA9IDQ1MFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHYueCA8IDEwICYmIHYueCA+IC00NTApIHtcclxuICAgICAgICAgICAgICAgIHYueCA9IC00NTBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAodGhpcy5pc1JpZ2h0KSB7XHJcbiAgICAgICAgICAgIC8vICAgICB2LnggPSA0NTA7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIHYueCA9IC00NTA7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBjYy5sb2coXCItLS0tMjExLS0tMjIyXCIpXHJcbiAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=
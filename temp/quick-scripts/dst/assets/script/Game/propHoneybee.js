
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/Game/propHoneybee.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '6d7ac8eB3xAsIBO/rgOFB1L', 'propHoneybee');
// script/Game/propHoneybee.ts

Object.defineProperty(exports, "__esModule", { value: true });
var CocosZ_1 = require("../Framework/CocosZ");
var Constant_1 = require("../Framework/Constant");
var _a = cc._decorator, ccclass = _a.ccclass, property = _a.property;
var propHoneybee = /** @class */ (function (_super) {
    __extends(propHoneybee, _super);
    function propHoneybee() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.rb = null;
        _this.num = 0;
        _this.direction = false;
        _this.isLimit = false;
        _this.isFan = false;
        return _this;
    }
    propHoneybee.prototype.onBeginContact = function (contact, self, other) {
        if (other.tag == Constant_1.tag.desPoint) {
            this.node.destroy();
        }
    };
    propHoneybee.prototype.onRayCast = function () {
        var startPos = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());
        //右
        var endPos = cc.v2(startPos.x + 1500, startPos.y);
        var result = CocosZ_1.cocosz.gameMgr.onRayCast(startPos, endPos);
        for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {
            var physics = result_1[_i];
            var cTag = physics.collider.tag;
            if (cTag == Constant_1.tag.player || cTag == Constant_1.tag.balloon || cTag == Constant_1.tag.rope) {
                var v = this.rb.linearVelocity;
                if (v.x < 0) {
                    v.x += 700;
                }
                this.rb.linearVelocity = v;
                // cc.log("-----------------------右");
                this.isLimit = true;
                CocosZ_1.cocosz.gameMgr.isFeed = true;
                return;
            }
            else if (cTag == Constant_1.tag.invisibleFloor) {
                continue;
            }
            else if (cTag == Constant_1.tag.thorn || cTag == Constant_1.tag.floorThorn || cTag == Constant_1.tag.moveFloor || cTag == Constant_1.tag.stone || cTag == 0) {
                break;
            }
        }
        //左
        var endPos2 = cc.v2(startPos.x - 1500, startPos.y);
        var result2 = CocosZ_1.cocosz.gameMgr.onRayCast(startPos, endPos2);
        for (var _a = 0, result2_1 = result2; _a < result2_1.length; _a++) {
            var physics = result2_1[_a];
            var cTag = physics.collider.tag;
            if (cTag == Constant_1.tag.player || cTag == Constant_1.tag.balloon || cTag == Constant_1.tag.rope) {
                var v = this.rb.linearVelocity;
                if (v.x > 0) {
                    v.x -= 700;
                }
                this.rb.linearVelocity = v;
                this.isLimit = true;
                CocosZ_1.cocosz.gameMgr.isFeed = true;
                return;
            }
            else if (cTag == Constant_1.tag.invisibleFloor) {
                continue;
            }
            else if (cTag == Constant_1.tag.thorn || cTag == Constant_1.tag.floorThorn || cTag == Constant_1.tag.moveFloor || cTag == Constant_1.tag.stone || cTag == 0) {
                break;
            }
        }
        //上
        var endPos3 = cc.v2(startPos.x, startPos.y + 1500);
        var result3 = CocosZ_1.cocosz.gameMgr.onRayCast(startPos, endPos3);
        for (var _b = 0, result3_1 = result3; _b < result3_1.length; _b++) {
            var physics = result3_1[_b];
            var cTag = physics.collider.tag;
            if (cTag == Constant_1.tag.player || cTag == Constant_1.tag.balloon || cTag == Constant_1.tag.rope || cTag == Constant_1.tag.balloon2) {
                var v = this.rb.linearVelocity;
                if (v.y < 0) {
                    v.y += 700;
                }
                this.rb.linearVelocity = v;
                this.isLimit = true;
                CocosZ_1.cocosz.gameMgr.isFeed = true;
                return;
            }
            else if (cTag == Constant_1.tag.invisibleFloor) {
                continue;
            }
            else if (cTag == Constant_1.tag.thorn || cTag == Constant_1.tag.floorThorn || cTag == Constant_1.tag.moveFloor || cTag == Constant_1.tag.stone || cTag == 0) {
                break;
            }
        }
        //下
        var endPos4 = cc.v2(startPos.x, startPos.y - 1500);
        var result4 = CocosZ_1.cocosz.gameMgr.onRayCast(startPos, endPos4);
        for (var _c = 0, result4_1 = result4; _c < result4_1.length; _c++) {
            var physics = result4_1[_c];
            var cTag = physics.collider.tag;
            if (cTag == Constant_1.tag.player || cTag == Constant_1.tag.balloon || cTag == Constant_1.tag.rope) {
                var v = this.rb.linearVelocity;
                if (v.y > 0) {
                    v.y -= 500;
                    if (!this.isFan) {
                        v.x = 0;
                    }
                    else {
                        v.y = 0;
                    }
                }
                this.rb.linearVelocity = v;
                this.isLimit = true;
                CocosZ_1.cocosz.gameMgr.isFeed = true;
                cc.log("-----------------------下");
                return;
            }
            else if (cTag == Constant_1.tag.invisibleFloor) {
                continue;
            }
            else if (cTag == Constant_1.tag.thorn || cTag == Constant_1.tag.floorThorn || cTag == Constant_1.tag.moveFloor || cTag == 0 || cTag == Constant_1.tag.stone) {
                break;
            }
        }
    };
    // LIFE-CYCLE CALLBACKS:
    propHoneybee.prototype.onLoad = function () {
        this.rb = this.node.getComponent(cc.RigidBody);
    };
    propHoneybee.prototype.start = function () {
        var _this = this;
        var pos = cc.v2(this.node.x, this.node.y);
        var hd = cc.v2(0, 100).signAngle(pos) / 2;
        this.node.angle = Math.ceil(hd / Math.PI * 180);
        var v = this.rb.linearVelocity;
        v.x = Math.random() * 300 - 150;
        v.y = Math.random() * 300 - 150;
        if (this.node.y <= -600 && v.y < 0) {
            v.y *= -1;
        }
        if (Math.random() > 0.5) {
            this.direction = !this.direction;
        }
        this.rb.linearVelocity = v;
        // this.onRayCast();
        // if(this.)/
        this.schedule(function () {
            _this.num++;
            var pos = cc.v2(_this.node.x, _this.node.y);
            var hd = cc.v2(0, 100).signAngle(pos) / 2;
            _this.node.angle = Math.ceil(hd / Math.PI * 180);
            var v = _this.rb.linearVelocity;
            v.x = Math.random() * 500 - 250;
            v.y = Math.random() * 300 - 150;
            if (_this.node.y <= -600 && v.y < 0 || (_this.node.y >= 700 && v.y > 0)) {
                v.y *= -1;
            }
            if (!(_this.num % 4) && Math.random() > 0.5) {
                _this.num = 0;
                _this.direction = !_this.direction;
                if (_this.direction) {
                    v.x = 300;
                }
                else {
                    v.x = -300;
                }
            }
            if (CocosZ_1.cocosz.sceneMgr.sceneName == "rewardLevel2") {
                if (v.x < 0) {
                    v.x *= -1;
                    v.y *= 0;
                }
                _this.rb.linearVelocity = v;
                return;
            }
            if (CocosZ_1.cocosz.dataMgr.CurLevelId == 57 || CocosZ_1.cocosz.dataMgr.CurLevelId == 134) {
                // cc.log(v.x, v.y, cocosz.gameMgr.isFeed)
                if (CocosZ_1.cocosz.gameMgr.isFeed) {
                    if (v.y > 0) {
                        v.y *= -1;
                    }
                    if (v.x < 0) {
                        v.x *= -1;
                    }
                }
                else {
                    if (v.x > 0) {
                        v.x *= -1;
                    }
                }
            }
            else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 61 || CocosZ_1.cocosz.dataMgr.CurLevelId == 130) {
                if (v.x < 0) {
                    v.x *= -1;
                }
            }
            else if (CocosZ_1.cocosz.dataMgr.CurLevelId == 66) {
                if (v.y > 0 && Math.random() > 0.3) {
                    v.y *= -1;
                }
            }
            _this.rb.linearVelocity = v;
            _this.onRayCast();
        }, 0.5);
    };
    propHoneybee.prototype.update = function (dt) {
    };
    propHoneybee = __decorate([
        ccclass
    ], propHoneybee);
    return propHoneybee;
}(cc.Component));
exports.default = propHoneybee;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxHYW1lXFxwcm9wSG9uZXliZWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDhDQUE2QztBQUM3QyxrREFBNEM7QUFDdEMsSUFBQSxrQkFBcUMsRUFBbkMsb0JBQU8sRUFBRSxzQkFBMEIsQ0FBQztBQUc1QztJQUEwQyxnQ0FBWTtJQUR0RDtRQUFBLHFFQW1OQztRQWhORyxRQUFFLEdBQWlCLElBQUksQ0FBQztRQUd4QixTQUFHLEdBQVcsQ0FBQyxDQUFDO1FBQ2hCLGVBQVMsR0FBWSxLQUFLLENBQUM7UUFFM0IsYUFBTyxHQUFZLEtBQUssQ0FBQTtRQUVqQixXQUFLLEdBQVksS0FBSyxDQUFDOztJQXdNbEMsQ0FBQztJQXZNRyxxQ0FBYyxHQUFkLFVBQWUsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLO1FBQy9CLElBQUksS0FBSyxDQUFDLEdBQUcsSUFBSSxjQUFHLENBQUMsUUFBUSxFQUFFO1lBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7U0FDdkI7SUFDTCxDQUFDO0lBRUQsZ0NBQVMsR0FBVDtRQUVJLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUMvRSxHQUFHO1FBQ0gsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxNQUFNLEdBQUcsZUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3hELEtBQW9CLFVBQU0sRUFBTixpQkFBTSxFQUFOLG9CQUFNLEVBQU4sSUFBTSxFQUFFO1lBQXZCLElBQUksT0FBTyxlQUFBO1lBQ1osSUFBSSxJQUFJ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QyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7cUJBQ2I7aUJBQ0o7YUFDSjtpQkFDSSxJQUFJLGVBQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxJQUFJLEVBQUUsSUFBSSxlQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsSUFBSSxHQUFHLEVBQUU7Z0JBQzFFLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUU7b0JBQ1QsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztpQkFDYjthQUNKO2lCQUNJLElBQUksZUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLElBQUksRUFBRSxFQUFFO2dCQUN0QyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLEVBQUU7b0JBQ2hDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7aUJBQ2I7YUFDSjtZQUNELEtBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQztZQUMzQixLQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDckIsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFBO0lBQ1gsQ0FBQztJQUVELDZCQUFNLEdBQU4sVUFBTyxFQUFFO0lBRVQsQ0FBQztJQWpOZ0IsWUFBWTtRQURoQyxPQUFPO09BQ2EsWUFBWSxDQWtOaEM7SUFBRCxtQkFBQztDQWxORCxBQWtOQyxDQWxOeUMsRUFBRSxDQUFDLFNBQVMsR0FrTnJEO2tCQWxOb0IsWUFBWSIsImZpbGUiOiIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvY29zeiB9IGZyb20gXCIuLi9GcmFtZXdvcmsvQ29jb3NaXCI7XHJcbmltcG9ydCB7IHRhZyB9IGZyb20gXCIuLi9GcmFtZXdvcmsvQ29uc3RhbnRcIjtcclxuY29uc3QgeyBjY2NsYXNzLCBwcm9wZXJ0eSB9ID0gY2MuX2RlY29yYXRvcjtcclxuXHJcbkBjY2NsYXNzXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIHByb3BIb25leWJlZSBleHRlbmRzIGNjLkNvbXBvbmVudCB7XHJcblxyXG4gICAgcmI6IGNjLlJpZ2lkQm9keSA9IG51bGw7XHJcblxyXG5cclxuICAgIG51bTogbnVtYmVyID0gMDtcclxuICAgIGRpcmVjdGlvbjogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIGlzTGltaXQ6IGJvb2xlYW4gPSBmYWxzZVxyXG5cclxuICAgIHB1YmxpYyBpc0ZhbjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgb25CZWdpbkNvbnRhY3QoY29udGFjdCwgc2VsZiwgb3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIudGFnID09IHRhZy5kZXNQb2ludCkge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblJheUNhc3QoKSB7XHJcblxyXG4gICAgICAgIGxldCBzdGFydFBvcyA9IHRoaXMubm9kZS5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKHRoaXMubm9kZS5nZXRQb3NpdGlvbigpKTtcclxuICAgICAgICAvL+WPs1xyXG4gICAgICAgIGxldCBlbmRQb3MgPSBjYy52MihzdGFydFBvcy54ICsgMTUwMCwgc3RhcnRQb3MueSk7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGNvY29zei5nYW1lTWdyLm9uUmF5Q2FzdChzdGFydFBvcywgZW5kUG9zKTtcclxuICAgICAgICBmb3IgKGxldCBwaHlzaWNzIG9mIHJlc3VsdCkge1xyXG4gICAgICAgICAgICBsZXQgY1RhZyA9IHBoeXNpY3MuY29sbGlkZXIudGFnO1xyXG4gICAgICAgICAgICBpZiAoY1RhZyA9PSB0YWcucGxheWVyIHx8IGNUYWcgPT0gdGFnLmJhbGxvb24gfHwgY1RhZyA9PSB0YWcucm9wZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHYgPSB0aGlzLnJiLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICAgICAgICAgaWYgKHYueCA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggKz0gNzAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgICAgICAvLyBjYy5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLeWPs1wiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMaW1pdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb2Nvc3ouZ2FtZU1nci5pc0ZlZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY1RhZyA9PSB0YWcuaW52aXNpYmxlRmxvb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNUYWcgPT0gdGFnLnRob3JuIHx8IGNUYWcgPT0gdGFnLmZsb29yVGhvcm4gfHwgY1RhZyA9PSB0YWcubW92ZUZsb29yIHx8IGNUYWcgPT0gdGFnLnN0b25lIHx8IGNUYWcgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/lt6ZcclxuICAgICAgICBsZXQgZW5kUG9zMiA9IGNjLnYyKHN0YXJ0UG9zLnggLSAxNTAwLCBzdGFydFBvcy55KTtcclxuICAgICAgICBsZXQgcmVzdWx0MiA9IGNvY29zei5nYW1lTWdyLm9uUmF5Q2FzdChzdGFydFBvcywgZW5kUG9zMik7XHJcbiAgICAgICAgZm9yIChsZXQgcGh5c2ljcyBvZiByZXN1bHQyKSB7XHJcbiAgICAgICAgICAgIGxldCBjVGFnID0gcGh5c2ljcy5jb2xsaWRlci50YWc7XHJcbiAgICAgICAgICAgIGlmIChjVGFnID09IHRhZy5wbGF5ZXIgfHwgY1RhZyA9PSB0YWcuYmFsbG9vbiB8fCBjVGFnID09IHRhZy5yb3BlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAodi54ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueCAtPSA3MDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMaW1pdCA9IHRydWVcclxuICAgICAgICAgICAgICAgIGNvY29zei5nYW1lTWdyLmlzRmVlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjVGFnID09IHRhZy5pbnZpc2libGVGbG9vcikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY1RhZyA9PSB0YWcudGhvcm4gfHwgY1RhZyA9PSB0YWcuZmxvb3JUaG9ybiB8fCBjVGFnID09IHRhZy5tb3ZlRmxvb3IgfHwgY1RhZyA9PSB0YWcuc3RvbmUgfHwgY1RhZyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/kuIpcclxuICAgICAgICBsZXQgZW5kUG9zMyA9IGNjLnYyKHN0YXJ0UG9zLngsIHN0YXJ0UG9zLnkgKyAxNTAwKTtcclxuICAgICAgICBsZXQgcmVzdWx0MyA9IGNvY29zei5nYW1lTWdyLm9uUmF5Q2FzdChzdGFydFBvcywgZW5kUG9zMyk7XHJcbiAgICAgICAgZm9yIChsZXQgcGh5c2ljcyBvZiByZXN1bHQzKSB7XHJcbiAgICAgICAgICAgIGxldCBjVGFnID0gcGh5c2ljcy5jb2xsaWRlci50YWc7XHJcbiAgICAgICAgICAgIGlmIChjVGFnID09IHRhZy5wbGF5ZXIgfHwgY1RhZyA9PSB0YWcuYmFsbG9vbiB8fCBjVGFnID09IHRhZy5yb3BlIHx8IGNUYWcgPT0gdGFnLmJhbGxvb24yKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAodi55IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueSArPSA3MDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJiLmxpbmVhclZlbG9jaXR5ID0gdjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMaW1pdCA9IHRydWVcclxuICAgICAgICAgICAgICAgIGNvY29zei5nYW1lTWdyLmlzRmVlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjVGFnID09IHRhZy5pbnZpc2libGVGbG9vcikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY1RhZyA9PSB0YWcudGhvcm4gfHwgY1RhZyA9PSB0YWcuZmxvb3JUaG9ybiB8fCBjVGFnID09IHRhZy5tb3ZlRmxvb3IgfHwgY1RhZyA9PSB0YWcuc3RvbmUgfHwgY1RhZyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/kuItcclxuICAgICAgICBsZXQgZW5kUG9zNCA9IGNjLnYyKHN0YXJ0UG9zLngsIHN0YXJ0UG9zLnkgLSAxNTAwKTtcclxuICAgICAgICBsZXQgcmVzdWx0NCA9IGNvY29zei5nYW1lTWdyLm9uUmF5Q2FzdChzdGFydFBvcywgZW5kUG9zNCk7XHJcbiAgICAgICAgZm9yIChsZXQgcGh5c2ljcyBvZiByZXN1bHQ0KSB7XHJcbiAgICAgICAgICAgIGxldCBjVGFnID0gcGh5c2ljcy5jb2xsaWRlci50YWc7XHJcbiAgICAgICAgICAgIGlmIChjVGFnID09IHRhZy5wbGF5ZXIgfHwgY1RhZyA9PSB0YWcuYmFsbG9vbiB8fCBjVGFnID09IHRhZy5yb3BlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAodi55ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueSAtPSA1MDA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRmFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0xpbWl0ID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgY29jb3N6LmdhbWVNZ3IuaXNGZWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t5LiLXCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjVGFnID09IHRhZy5pbnZpc2libGVGbG9vcikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY1RhZyA9PSB0YWcudGhvcm4gfHwgY1RhZyA9PSB0YWcuZmxvb3JUaG9ybiB8fCBjVGFnID09IHRhZy5tb3ZlRmxvb3IgfHwgY1RhZyA9PSAwIHx8IGNUYWcgPT0gdGFnLnN0b25lKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIExJRkUtQ1lDTEUgQ0FMTEJBQ0tTOlxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLnJiID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5SaWdpZEJvZHkpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIGxldCBwb3MgPSBjYy52Mih0aGlzLm5vZGUueCwgdGhpcy5ub2RlLnkpO1xyXG4gICAgICAgIGxldCBoZCA9IGNjLnYyKDAsIDEwMCkuc2lnbkFuZ2xlKHBvcykgLyAyO1xyXG4gICAgICAgIHRoaXMubm9kZS5hbmdsZSA9IE1hdGguY2VpbChoZCAvIE1hdGguUEkgKiAxODApO1xyXG4gICAgICAgIGxldCB2ID0gdGhpcy5yYi5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICB2LnggPSBNYXRoLnJhbmRvbSgpICogMzAwIC0gMTUwO1xyXG4gICAgICAgIHYueSA9IE1hdGgucmFuZG9tKCkgKiAzMDAgLSAxNTA7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZS55IDw9IC02MDAgJiYgdi55IDwgMCkge1xyXG4gICAgICAgICAgICB2LnkgKj0gLTE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSAhdGhpcy5kaXJlY3Rpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgIC8vIHRoaXMub25SYXlDYXN0KCk7XHJcbiAgICAgICAgLy8gaWYodGhpcy4pL1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm51bSsrO1xyXG4gICAgICAgICAgICBsZXQgcG9zID0gY2MudjIodGhpcy5ub2RlLngsIHRoaXMubm9kZS55KTtcclxuICAgICAgICAgICAgbGV0IGhkID0gY2MudjIoMCwgMTAwKS5zaWduQW5nbGUocG9zKSAvIDI7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hbmdsZSA9IE1hdGguY2VpbChoZCAvIE1hdGguUEkgKiAxODApO1xyXG4gICAgICAgICAgICBsZXQgdiA9IHRoaXMucmIubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgICAgICAgIHYueCA9IE1hdGgucmFuZG9tKCkgKiA1MDAgLSAyNTA7XHJcbiAgICAgICAgICAgIHYueSA9IE1hdGgucmFuZG9tKCkgKiAzMDAgLSAxNTA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUueSA8PSAtNjAwICYmIHYueSA8IDAgfHwgKHRoaXMubm9kZS55ID49IDcwMCAmJiB2LnkgPiAwKSkge1xyXG4gICAgICAgICAgICAgICAgdi55ICo9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghKHRoaXMubnVtICUgNCkgJiYgTWF0aC5yYW5kb20oKSA+IDAuNSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5udW0gPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSAhdGhpcy5kaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggPSAzMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnggPSAtMzAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb2Nvc3ouc2NlbmVNZ3Iuc2NlbmVOYW1lID09IFwicmV3YXJkTGV2ZWwyXCIpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodi54IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHYueCAqPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB2LnkgKj0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMucmIubGluZWFyVmVsb2NpdHkgPSB2O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb2Nvc3ouZGF0YU1nci5DdXJMZXZlbElkID09IDU3IHx8IGNvY29zei5kYXRhTWdyLkN1ckxldmVsSWQgPT0gMTM0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjYy5sb2codi54LCB2LnksIGNvY29zei5nYW1lTWdyLmlzRmVlZClcclxuICAgICAgICAgICAgICAgIGlmIChjb2Nvc3ouZ2FtZU1nci5pc0ZlZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodi55ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnkgKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2LnggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHYueCAqPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodi54ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2LnggKj0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvY29zei5kYXRhTWdyLkN1ckxldmVsSWQgPT0gNjEgfHwgY29jb3N6LmRhdGFNZ3IuQ3VyTGV2ZWxJZCA9PSAxMzApIHtcclxuICAgICAgICAgICAgICAgIGlmICh2LnggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdi54ICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvY29zei5kYXRhTWdyLkN1ckxldmVsSWQgPT0gNjYpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2LnkgPiAwICYmIE1hdGgucmFuZG9tKCkgPiAwLjMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2LnkgKj0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5yYi5saW5lYXJWZWxvY2l0eSA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMub25SYXlDYXN0KCk7XHJcbiAgICAgICAgfSwgMC41KVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZShkdCkge1xyXG5cclxuICAgIH1cclxufVxyXG4iXX0=
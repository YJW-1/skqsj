{"version":3,"sources":["assets\\script\\Framework\\GameMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { cocosz } from \"./CocosZ\";\r\nimport Constant, { PanelName } from \"./Constant\";\r\nimport GameCtr from \"./GameCtr\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameMgr {\r\n\r\n    private static _inst: GameMgr;\r\n    public static get inst(): GameMgr {\r\n        if (!GameMgr._inst) {\r\n            GameMgr._inst = new GameMgr();\r\n        }\r\n        return GameMgr._inst;\r\n    }\r\n\r\n\r\n    isDelay: boolean = false;\r\n    private _gameCtr: GameCtr = null;\r\n\r\n    public audioBg: boolean = true;\r\n\r\n    /**记录过关数 奖励关卡用 */\r\n    public LevelNum: number = 2;\r\n\r\n\r\n    /**记录过关数 抽奖用 */\r\n    public LevelNum2: number = 0;\r\n\r\n\r\n\r\n    /**记录过关数 添加桌面用 */\r\n    public playGameNum: number = 0;\r\n\r\n    /**关卡金币总数 */\r\n    public maxCoin: number = 4;\r\n\r\n    /**关卡获得金币总数 */\r\n    public coinNum: number = 4;\r\n\r\n    //游戏结束\r\n    public isGameOver: boolean = false;\r\n\r\n\r\n    //奖励关卡类型\r\n    public rewardType: number = 0;\r\n\r\n\r\n    //游戏结束\r\n    public isStartDef: boolean = false\r\n\r\n\r\n    /**左边气球是否爆炸 */\r\n    public isLeftBalloon: boolean = false;\r\n\r\n\r\n    /**右边气球是否爆炸 */\r\n    public isrightBalloon: boolean = false;\r\n\r\n\r\n    /**发现气球 */\r\n    public isFeed: boolean = false;\r\n\r\n\r\n    /**2个控制按钮 */\r\n    public isOpen: boolean = false;\r\n\r\n\r\n    /**是否已经复活 */\r\n    public isResurrection: boolean = false;\r\n\r\n    /**是否第一次进入*/\r\n    public isFirst: boolean = false;\r\n\r\n\r\n    /**是否第一次进入*/\r\n    public isFirst2: boolean = false;\r\n\r\n    /**是否关卡全开 */\r\n    public isLevelOpen: boolean = false;\r\n\r\n\r\n    /**是否开启奖励关卡 */\r\n    public isOpenRewardLevel: boolean = false;\r\n\r\n\r\n    /**是否开启抽奖 */\r\n    public isOpenLottery: boolean = false;\r\n\r\n\r\n    /**当前商店皮肤id*/\r\n    public curShopSkinID: number = -1;\r\n\r\n\r\n\r\n    /**当前关卡id*/\r\n    public curLevelID: number = 0;\r\n\r\n\r\n    /**当前剩余关卡*/\r\n    public seleltLevelList: any = [];\r\n\r\n    /**当前剩余关卡数*/\r\n    public surplusLevelNum: number = 0;\r\n\r\n    /**分数*/\r\n    public fraction: number = 0;\r\n\r\n    /**无尽关卡分数*/\r\n    public game2Fraction: number = 0;\r\n\r\n    /**镜头屏幕数,点击位置偏移*/\r\n    public touchNum: number = 0;\r\n\r\n\r\n    /**无尽模式复活标记*/\r\n    public isGame2Resurrection: boolean = false;\r\n\r\n\r\n    /**无尽模式当前关卡id*/\r\n    public curGame2LevelID: number = 0;\r\n\r\n\r\n    /**无尽模式总关卡id*/\r\n    public MaxGame2LevelID: number = 0;\r\n\r\n\r\n\r\n    /**无尽模式当前关卡数据*/\r\n    public curLevelJson: number = 0;\r\n\r\n    /**无尽模式当前关卡数据*/\r\n    public handNum: number = 0;\r\n\r\n\r\n    public onBalloonDes(name) {\r\n        cc.log(this.isrightBalloon, this.isLeftBalloon, name)\r\n        if (name == \"left_balloon\") {\r\n            this.isLeftBalloon = true;\r\n        }\r\n        else if (name == \"right_balloon\") {\r\n            this.isrightBalloon = true;\r\n        }\r\n\r\n        if (this.isrightBalloon && this.isLeftBalloon && this.isGameOver == false) {\r\n            cc.log(\"两只气球爆炸\")\r\n            // this.isGameOver = true;\r\n            cocosz.audioMgr.playBeforeFeildEffect1();\r\n            cc.game.emit(Constant.E_PROP_ALLBALLOONDES);\r\n\r\n\r\n            // if (cc.sys.platform === cc.sys.WECHAT_GAME && cocosz.dataMgr.ShockOn) {\r\n            //     window[\"wx\"].vibrateLong();\r\n            // }\r\n\r\n            // cocosz.scheduleOnce(() => {\r\n            //     cocosz.uiMgr.openPanel(PanelName.UiFailed);\r\n            // }, 1)\r\n            cc.game.emit(Constant.E_GAME_FAID)\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 射线检测（有序）\r\n    */\r\n    onRayCast(start, end) {\r\n        let result = cc.director.getPhysicsManager().rayCast(start, end, cc.RayCastType.All);\r\n        let dict = {};\r\n        let list = [];\r\n        let newResult = [];\r\n        start.x = Math.round(start.x);\r\n        start.y = Math.round(start.y);\r\n        end.x = Math.round(end.x);\r\n        end.y = Math.round(end.y);\r\n        if (start.y == end.y) {\r\n            for (let rb of result) {\r\n                let point = rb.point;\r\n                point.x = Math.round(point.x);\r\n                point.y = Math.round(point.y);\r\n                let len = Math.abs(start.x - point.x);\r\n                dict[len] = rb;\r\n                list.push(len);\r\n            }\r\n            list.sort((a, b) => { return a - b });\r\n            for (let len of list) {\r\n                newResult.push(dict[len]);\r\n            }\r\n        }\r\n        else {\r\n            for (let rb of result) {\r\n                let point = rb.point;\r\n                let len = Math.abs(start.y - point.y);\r\n                dict[len] = rb;\r\n                list.push(len);\r\n            }\r\n            list.sort((a, b) => { return a - b });\r\n            for (let len of list) {\r\n                newResult.push(dict[len]);\r\n            }\r\n        }\r\n        return newResult;\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param node \r\n     * @param MaxScale 最大值 \r\n     * @param smallest  最小值\r\n     */\r\n    public tweeBtn(node: cc.Node, MaxScale: number, smallScale: number) {\r\n        let scale = cc.tween()\r\n            .to(0.5, { scale: MaxScale })\r\n            .to(0.5, { scale: smallScale })\r\n        cc.tween(node)\r\n            .then(scale)\r\n            .repeatForever()\r\n            .start()\r\n    }\r\n\r\n    public tweeNode(node: cc.Node) {\r\n        cc.tween(node)\r\n            .to(0.3, { scale: 1 }, { easing: \"backOut\" })\r\n            .start();\r\n    }\r\n\r\n    public initGame() {\r\n        let node = new cc.Node();\r\n        node.group = \"default\";\r\n        node.zIndex = -1;\r\n        node.name = \"Game\";\r\n        this._gameCtr = node.addComponent(\"NormalModelCtr\");\r\n        cc.director.getScene().addChild(node);\r\n    }\r\n\r\n}\r\n"]}
{"version":3,"sources":["assets\\script\\Ui\\rewardLevel2.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\nimport { PanelName } from \"../Framework/Constant\";\r\nimport Msg from \"../Framework/Msg\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class rewardLevel extends cc.Component {\r\n\r\n    coinMgr: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bg: cc.Node = null;\r\n    coinCur: cc.Label = null;\r\n    time: cc.Label = null;\r\n\r\n    timeNum: number = 25;\r\n\r\n\r\n\r\n    onSucceed() {\r\n        if (cocosz.gameMgr.isGameOver) return;\r\n        cocosz.gameMgr.isGameOver = true;\r\n\r\n        this.node.getChildByName(\"Coin\").active = false;\r\n        cocosz.audioMgr.playBeforeVectoryEffect();\r\n        cocosz.unscheduleAllCallbacks();\r\n\r\n        // if (cc.sys.platform === cc.sys.VIVO_GAME && cocosz.dataMgr.ShockOn) {\r\n        //     lieyou_SdkManager.vibrateLong();\r\n        // }\r\n\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME && cocosz.dataMgr.ShockOn) {\r\n            window[\"wx\"].vibrateLong();\r\n        }\r\n        this.scheduleOnce(() => {\r\n            cocosz.uiMgr.openPanel(PanelName.UiBeforeSucceed);\r\n        }, 1.5)\r\n    }\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.coinMgr = this.node.parent.getChildByName(\"coinMgr\");\r\n        this.coinCur = this.node.getChildByName(\"Coin\").getChildByName(\"num\").getComponent(cc.Label);\r\n        this.time = this.node.getChildByName(\"time\").getChildByName(\"num\").getComponent(cc.Label);\r\n        this.coinCur.string = cocosz.dataMgr.CoinCount.toString();\r\n        if (!cc.director.getPhysicsManager().enabled) {\r\n            // cc.find('PROFILER-NODE').scale = 2;\r\n            cc.director.getPhysicsManager().enabled = true;\r\n            cc.director.getCollisionManager().enabled = true;\r\n            // 开启物理步长的设置\r\n            // cc.director.getPhysicsManager().enabledAccumulator = true;\r\n            // // 物理步长，默认 FIXED_TIME_STEP 是 1/60\r\n            // cc.PhysicsManager.FIXED_TIME_STEP = 1 / 60;\r\n            // // 每次更新物理系统处理速度的迭代次数，默认为 10\r\n            // cc.PhysicsManager.VELOCITY_ITERATIONS = 8;\r\n            // // 每次更新物理系统处理位置的迭代次数，默认为 10\r\n            // cc.PhysicsManager.POSITION_ITERATIONS = 8;\r\n            cc.director.getPhysicsManager().debugDrawFlags = 1;\r\n            // cc.director.getCollisionManager().enabledDebugDraw = true;\r\n            // var Bits = cc.PhysicsManager.DrawBits;\r\n            // cc.director.getPhysicsManager().debugDrawFlags =\r\n            //     Bits.e_aabbBit |\r\n            //     Bits.e_jointBit |\r\n            //     Bits.e_shapeBit;\r\n\r\n\r\n            this.bg.zIndex -= 1000;\r\n        }\r\n    }\r\n\r\n    start() {\r\n        // let gameBg = cocosz.resMgr.getRes(\"gameBg\", cc.Prefab);\r\n        // this.node.parent.addChild(cc.instantiate(gameBg), -100);\r\n        let propHoneybee = cocosz.resMgr.getRes(\"coin\", cc.Prefab);\r\n\r\n        let num = 2 * Math.random() + 3;\r\n        for (let i = 0; i < num; i++) {\r\n            let node = cc.instantiate(propHoneybee);\r\n            node.setPosition(cc.v2(Math.random() * 700 - 250, Math.random() * 100 - 500))\r\n            this.coinMgr.addChild(node);\r\n        }\r\n\r\n\r\n        let map = this.node.getChildByName(\"map\");\r\n        let point = map.getComponent(cc.PhysicsPolygonCollider).points;\r\n\r\n        let prefab = cocosz.resMgr.getRes(\"mapMask\", cc.Prefab)\r\n        let node = cc.instantiate(prefab);\r\n        // node.x = list.x\r\n        // node.y = list.y\r\n\r\n        this.node.parent.addChild(node);\r\n        // node.zIndex -= 999;\r\n        let mask: cc.Mask = node.getComponent(cc.Mask);\r\n        let graphics = mask._graphics;\r\n        let graphics2: cc.Graphics = node.getChildByName(\"line\").getComponent(cc.Graphics);\r\n        let rb = node.addComponent(cc.RigidBody);\r\n        rb.type = cc.RigidBodyType.Static;\r\n\r\n        // for (let point of list) {\r\n        let collider = node.addComponent(cc.PhysicsPolygonCollider);\r\n        collider.points = [].concat(point);\r\n        collider.apply();\r\n\r\n        graphics.moveTo(point[0].x, point[0].y);\r\n        for (let v2 of point) {\r\n            graphics.lineTo(v2.x, v2.y);\r\n        }\r\n        graphics.fill();\r\n\r\n\r\n\r\n        graphics2.lineWidth = 15;\r\n        graphics2.strokeColor = new cc.Color(40, 33, 13, 255);\r\n        graphics2.moveTo(point[0].x, point[0].y);\r\n        for (let v2 of point) {\r\n            graphics2.lineTo(v2.x, v2.y);\r\n        }\r\n        graphics2.lineTo(point[0].x, point[0].y);\r\n        graphics2.stroke();\r\n        map.removeFromParent();\r\n\r\n        // }\r\n\r\n        this.schedule(() => {\r\n            let num = 2 * Math.random() + 3;\r\n            for (let i = 0; i < num; i++) {\r\n                let node = cc.instantiate(propHoneybee);\r\n                node.setPosition(cc.v2(Math.random() * 700 - 250, Math.random() * 100 - 500))\r\n                this.coinMgr.addChild(node);\r\n            }\r\n        }, 1.5)\r\n\r\n        cocosz.scheduleOnce(() => {\r\n            Msg.Show(\"在规定的时间内获取更多的金币\")\r\n        }, 1.5)\r\n        cocosz.gameMgr.LevelNum = 0\r\n        cocosz.gameMgr.isOpenRewardLevel = false;\r\n\r\n    }\r\n\r\n    update(dt) {\r\n        if (cocosz.gameMgr.isGameOver) return;\r\n        if (this.timeNum > 0) {\r\n            this.timeNum -= dt;\r\n            if (this.timeNum <= 3) {\r\n                this.unscheduleAllCallbacks();\r\n            }\r\n            if (this.timeNum > 0) {\r\n                let str = \"\";\r\n                if (this.timeNum < 10) {\r\n                    str += \"0\";\r\n                }\r\n                this.time.string = \"00:\" + str + Math.floor(this.timeNum)\r\n            }\r\n            else {\r\n                this.onSucceed();\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
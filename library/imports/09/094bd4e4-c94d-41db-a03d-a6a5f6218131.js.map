{"version":3,"sources":["assets\\script\\Game\\rewardRocket.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { cocosz } from \"../Framework/CocosZ\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class rewardRocket extends cc.Component {\r\n    minDistance: number = 0;\r\n    maxDistance: number = 0;\r\n    pos: any = 0;\r\n    floor: cc.Node = null;\r\n    role: cc.Node = null;\r\n    isStop: boolean = false;\r\n\r\n    isTouch: boolean = false;\r\n\r\n\r\n    endPos: number = 0;\r\n\r\n    x: number = -9999;\r\n\r\n    y: number = -9999;\r\n\r\n    rb: cc.RigidBody = null\r\n\r\n    isFirstMove = false;\r\n\r\n    moveDis: number = 0;\r\n\r\n    rocket: cc.Node = null\r\n\r\n\r\n    isLaunch: boolean = false;\r\n\r\n    onInitDistance() {\r\n        this.minDistance = -435\r\n        this.maxDistance = 430\r\n    }\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n\r\n        this.floor = this.node.getChildByName(\"floor\");\r\n        this.rocket = this.node.getChildByName(\"rocket\");\r\n        this.rb = this.node.getComponent(cc.RigidBody);\r\n    }\r\n\r\n    start() {\r\n        this.onInitDistance();\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n            let pos = this.node.parent.convertToNodeSpaceAR(event.getLocation());\r\n            this.pos = pos;\r\n            this.node.getChildByName(\"floor\").active = true;\r\n            this.isTouch = true;\r\n        })\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, (event) => {\r\n            // cc.game.emit(Constant.E_TIPS_NEXT)\r\n            let pos = this.node.parent.convertToNodeSpaceAR(event.getLocation());\r\n            if (this.node.angle == 90) {\r\n\r\n                let dis = this.pos.x - pos.x;\r\n                this.pos = pos;\r\n                let x = 0 + this.node.x;\r\n\r\n                if (x - dis <= this.maxDistance && x - dis >= this.minDistance) {\r\n                    if (!this.isFirstMove) {\r\n                        this.isFirstMove = true;\r\n                    }\r\n                    this.node.x = x - dis;\r\n                    this.moveDis++;\r\n                }\r\n            }\r\n            else {\r\n                let dis = this.pos.y - pos.y;\r\n                this.pos = pos;\r\n                let y = 0 + this.node.y;\r\n                // cc.log(y - dis, this.maxDistance, this.minDistance)\r\n                if (y - dis <= this.maxDistance && y - dis >= this.minDistance) {\r\n                    this.node.y = y - dis;\r\n                    this.moveDis++;\r\n                    // let pp = this.node.parent.convertToWorldSpaceAR(this.node.getPosition());\r\n                    // let pp2 = this.node.convertToNodeSpaceAR(pp);\r\n                    // this.rocket.setPosition(pp2);\r\n                    // this.rocket.y = this.node.y * this.node.scaleY\r\n                    if (!this.isFirstMove) {\r\n                        this.isFirstMove = true;\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, (event) => {\r\n            if (this.floor) {\r\n                this.floor.active = false;\r\n            }\r\n            this.isTouch = false;\r\n            this.isFirstMove = false;\r\n            this.moveDis = 0;\r\n        })\r\n        this.node.on(cc.Node.EventType.TOUCH_END, (event) => {\r\n            if (this.floor) {\r\n                this.floor.active = false;\r\n            }\r\n            this.isTouch = false;\r\n            this.isFirstMove = false;\r\n            this.moveDis = 0;\r\n        })\r\n\r\n\r\n        this.schedule(() => {\r\n            let node = cc.instantiate(this.rocket);\r\n            this.rocket.parent.addChild(node);\r\n            let rb = node.addComponent(cc.RigidBody);\r\n            rb.enabledContactListener = true\r\n            rb.type = cc.RigidBodyType.Kinematic;\r\n\r\n            let boxPhy = node.addComponent(cc.PhysicsBoxCollider);\r\n            boxPhy.tag = 31;\r\n            boxPhy.size.width = 60;\r\n            boxPhy.size.height = 30;\r\n            boxPhy.apply();\r\n\r\n\r\n            let v = rb.linearVelocity;\r\n            v.y = 1000;\r\n            rb.linearVelocity = v;\r\n        }, 0.3)\r\n    }\r\n\r\n    update(dt) {\r\n\r\n        if (cocosz.gameMgr.isGameOver) {\r\n            this.unscheduleAllCallbacks()\r\n        }\r\n    }\r\n}\r\n"]}